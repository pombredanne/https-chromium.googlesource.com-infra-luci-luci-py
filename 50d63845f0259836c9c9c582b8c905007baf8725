{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1d6f7a06_35b1925d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 11,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-06T23:30:16Z",
      "side": 1,
      "message": "better to add link to design doc in the first comment",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6bb4f7d0_df0827a4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 11,
      "author": {
        "id": 1409819
      },
      "writtenOn": "2021-08-12T23:31:32Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1d6f7a06_35b1925d",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b3f203f8_0ccc7b67",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 11,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-13T02:28:24Z",
      "side": 1,
      "message": "It is good to have meeting note there, but I meant design doc instead of meeting note.",
      "parentUuid": "6bb4f7d0_df0827a4",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "41da03a5_a650f896",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-06T23:30:16Z",
      "side": 1,
      "message": "How do you think the last comment in https://docs.google.com/document/d/1SfgQBrsgvLei_JrbA-m-KbIJL7kuE4IMvzaY_be8R50/edit?disco\u003dAAAANZeNf9w\n?",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9730e4b7_a93d4529",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1372464
      },
      "writtenOn": "2021-08-09T20:19:24Z",
      "side": 1,
      "message": "I think I may have misunderstood the scope of that comment. It was my understanding that we would import the full nsjail proto into swarming, but that the task properties message in swarming_rpcs.py would include only a subset of those properties. Is this not what you had in mind?",
      "parentUuid": "41da03a5_a650f896",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e8c0bee6_da45e2bc",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-10T00:52:39Z",
      "side": 1,
      "message": "I\u0027d like to have the same structure for bq schema and rpc message.",
      "parentUuid": "9730e4b7_a93d4529",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "30be00da_1a87fefb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1372464
      },
      "writtenOn": "2021-08-10T02:24:28Z",
      "side": 1,
      "message": "I see. In this case, I\u0027m not sure it makes sense to create a custom proto message that is a subset of the nsjail configuration; any time we wanted to use a new feature, we would need to roll the RPC definition, which doesn\u0027t seem like a good way to do things.\n\nFrom that comment thread, it seems that the main reason to have a subset is to do the strictness comparison between task properties and pool defaults. Is that correct? If so, I think we\u0027re willing to avoid the comparison for now.",
      "parentUuid": "e8c0bee6_da45e2bc",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "981c4092_b633bd86",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-10T02:37:50Z",
      "side": 1,
      "message": "I think we won\u0027t require new feature frequently, and I\u0027d like to narrow down the scope of knowledge by having only necessary part of configs we need to handle nsjail.\nI also want to know the context of each feature addition to nsjail config.\n\nAlso if you are fine to avoid comparison check, task owners can prepend nsjail in their task with arbitrary nsjail config. Then I\u0027m wondering why you need support for that in Swarming layer.\nDid you consider adding this feature to task triggering layer instead?",
      "parentUuid": "30be00da_1a87fefb",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6bb847a_e820018c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1372464
      },
      "writtenOn": "2021-08-10T05:06:58Z",
      "side": 1,
      "message": "Sorry, I don\u0027t have a lot of familiarity with the task triggering layer - can you point me to some code? \n\nOur main thought process here was that nsjail was the conceptual equivalent of a JobObject in Windows, and thus should belong in the same part of the stack. It also seemed easiest to implement pool level defaults by including it at this level. \n\nAs for the strictness check, I still want to keep the option to do this in the future open, but I don\u0027t want to block on it for this particular effort, as BCID does not require it.",
      "parentUuid": "981c4092_b633bd86",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1faea18b_ed10d2ca",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-10T06:57:32Z",
      "side": 1,
      "message": "\u003e Sorry, I don\u0027t have a lot of familiarity with the task triggering layer - can you point me to some code? \n\u003e \n\nThat depends on which task you want to use nsjail, and we are familar to such layer too as those are configured by our customers.\ne.g. I guess buildbucket constructs tasks around\nhttps://chromium.googlesource.com/infra/infra/+/refs/heads/main/appengine/cr-buildbucket/swarming.py#115\n\n\nAlso if you are not famliar to task triggering layer, it is better to check how will you have task specific nsjail config.\nAnd I think if you can support task specific nsjail config in task triggering layer, it won\u0027t be so difficult to prepend nsjail to task request.\n\n\u003e Our main thought process here was that nsjail was the conceptual equivalent of a JobObject in Windows, and thus should belong in the same part of the stack. It also seemed easiest to implement pool level defaults by including it at this level. \n\u003e \n\u003e As for the strictness check, I still want to keep the option to do this in the future open, but I don\u0027t want to block on it for this particular effort, as BCID does not require it.\n\nI see. Then I think you need to consider whether you trust task triggerer and they won\u0027t send request doing bad thing with less restricted nsjail config.",
      "parentUuid": "a6bb847a_e820018c",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "53a5b4fd_32f15a1a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1409819
      },
      "writtenOn": "2021-08-12T23:31:32Z",
      "side": 1,
      "message": "As we\u0027ve discussed, I\u0027m now adding only a subset of nsjail configs in the proto.",
      "parentUuid": "1faea18b_ed10d2ca",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a5cdd337_9864e32c",
        "filename": "appengine/swarming/proto/api/nsjail.proto",
        "patchSetId": 3
      },
      "lineNbr": 1,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2021-08-10T00:52:39Z",
      "side": 1,
      "message": "This is not used?",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "708d9371_7d8ea92c",
        "filename": "appengine/swarming/proto/api/nsjail.proto",
        "patchSetId": 3
      },
      "lineNbr": 1,
      "author": {
        "id": 1409819
      },
      "writtenOn": "2021-08-12T23:31:32Z",
      "side": 1,
      "message": "It\u0027s used now.",
      "parentUuid": "a5cdd337_9864e32c",
      "revId": "50d63845f0259836c9c9c582b8c905007baf8725",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}