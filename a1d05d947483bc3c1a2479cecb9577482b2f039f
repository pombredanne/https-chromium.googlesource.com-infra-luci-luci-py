{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "9d2c1ddb_5425210c",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 6
      },
      "lineNbr": 535,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2022-10-06T19:32:09Z",
      "side": 1,
      "message": "The primary reason is that by calling it outside of the transaction, we allow ndb to fetch it from memcache (ndb maintains transparent magical cache for all entities by default). This is almost \"free\". This cache is disabled inside the transaction, so we\u0027ll always be making an RPC to datastore.",
      "range": {
        "startLine": 535,
        "startChar": 4,
        "endLine": 535,
        "endChar": 21
      },
      "revId": "a1d05d947483bc3c1a2479cecb9577482b2f039f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "71008dd9_5f326e73",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 6
      },
      "lineNbr": 535,
      "author": {
        "id": 1547372
      },
      "writtenOn": "2022-10-06T19:44:06Z",
      "side": 1,
      "message": "Interesting, just confirming that this is related to the context cache mentioned here: https://cloud.google.com/appengine/docs/legacy/standard/python/ndb/cache",
      "parentUuid": "9d2c1ddb_5425210c",
      "range": {
        "startLine": 535,
        "startChar": 4,
        "endLine": 535,
        "endChar": 21
      },
      "revId": "a1d05d947483bc3c1a2479cecb9577482b2f039f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89375b01_5adb9cb0",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 6
      },
      "lineNbr": 535,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2022-10-06T19:50:14Z",
      "side": 1,
      "message": "Yes, memcache part specifically https://cloud.google.com/appengine/docs/legacy/standard/python/ndb/cache#memcache\n\nThe \"In-Context Cache\" is ~\u003d useless waste of memory and CPU.",
      "parentUuid": "71008dd9_5f326e73",
      "range": {
        "startLine": 535,
        "startChar": 4,
        "endLine": 535,
        "endChar": 21
      },
      "revId": "a1d05d947483bc3c1a2479cecb9577482b2f039f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e1e22cc3_3d3988a9",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 6
      },
      "lineNbr": 535,
      "author": {
        "id": 1547372
      },
      "writtenOn": "2022-10-11T16:22:29Z",
      "side": 1,
      "message": "üëç",
      "parentUuid": "89375b01_5adb9cb0",
      "range": {
        "startLine": 535,
        "startChar": 4,
        "endLine": 535,
        "endChar": 21
      },
      "revId": "a1d05d947483bc3c1a2479cecb9577482b2f039f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ee791910_5d565df7",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 6
      },
      "lineNbr": 535,
      "author": {
        "id": 1547372
      },
      "writtenOn": "2022-10-11T16:22:59Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e1e22cc3_3d3988a9",
      "range": {
        "startLine": 535,
        "startChar": 4,
        "endLine": 535,
        "endChar": 21
      },
      "revId": "a1d05d947483bc3c1a2479cecb9577482b2f039f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}