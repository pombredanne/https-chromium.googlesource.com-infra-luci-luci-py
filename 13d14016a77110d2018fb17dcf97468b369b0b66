{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c1339e99_be615117",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2023-03-21T22:48:43Z",
      "side": 1,
      "message": "I don\u0027t think it would work correctly when bot self-updates itself (in reexecs itself, parameters will be lost). It is also not propagating parameters to subprocesses like task_runner.py. Propagating them correctly may be complicated.\n\nI very much prefer investigating possibility to removing tsmon here completely. I don\u0027t know anyone who looks at these metrics (but I haven\u0027t researched).",
      "revId": "13d14016a77110d2018fb17dcf97468b369b0b66",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2c07068c_8ec27de1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1529882
      },
      "writtenOn": "2023-03-22T06:18:35Z",
      "side": 1,
      "message": "Ah thanks, I did not think about handling bots updating.\n\nAs I think the only case we care about solving this is ChromeOS Skylab b/265099146 – I guess we could consider setting an env var visible to all processes inside the drone container that tells Swarming bot to use a different tsmon hostname based off its botid.\n\nOr I guess the other place for persistent config is the bot_config.py script inserted by the server.\n\nHowever I agree – I would be happy to remove these metrics. The only ones I can find are /chrome/infra/http/response_status http://shortn/_d58ghUUr6W (with HTTP client metrics only about tsmon itself!) and /chrome/infra/http/response_status http://shortn/_squMOZv9j5 – but I have not looked exhaustively.\n\nIn practice when troubleshooting swarming bot issues, I’ve always gone straight to the bot and server logs, and not metrics. I don\u0027t think we use these ones for alerting.",
      "parentUuid": "c1339e99_be615117",
      "revId": "13d14016a77110d2018fb17dcf97468b369b0b66",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c16b72da_2d0abd55",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2023-03-22T07:09:31Z",
      "side": 1,
      "message": "There\u0027s some ancient viceroy dashboards which use the above metrics that Doug pointed out (whether anyone uses them is another question): https://source.corp.google.com/piper///depot/google3/monitoring/viceroy/dashboards/chrome_infra/generic/_http.html\n\nThere\u0027s also some alerting tied to the /chrome/infra/presence/up metric.\nFuchsia infra uses it to detect a host down\nhttps://source.corp.google.com/piper///depot/google3/configs/monitoring/turquoise_infra/foundation/swarming/alerts.py;l\u003d166\n\nCHOPs also has this task down alert (unsure if Foundation is using this): https://source.corp.google.com/piper///depot/google3/configs/monitoring/chrome_ops_monitoring/common/gcp/presence.py;l\u003d9\n\nI think getting rid of ts_mon is a good approach and we can selectively do this for ChromeOS Swarming.\nhttps://source.chromium.org/chromium/infra/infra/+/main:luci/appengine/swarming/swarming_bot/bot_code/bot_main.py;l\u003d1139",
      "parentUuid": "2c07068c_8ec27de1",
      "revId": "13d14016a77110d2018fb17dcf97468b369b0b66",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0384792b_7a954f74",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1351748
      },
      "writtenOn": "2023-10-19T00:18:53Z",
      "side": 1,
      "message": "Hi folks, what is the status of this CL?",
      "revId": "13d14016a77110d2018fb17dcf97468b369b0b66",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}