{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "7e74e7b6_21a2ef3e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "PTAL. I hope it makes sense to you...\n\nI\u0027m rewriting acl_test.py now, because tests there are crap.",
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "172d6de4_7e54fecc",
        "filename": "appengine/components/components/config/proto/service_config.proto",
        "patchSetId": 1
      },
      "lineNbr": 255,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "This will be either only \"auth-luci-services\" or perhaps auth-luci-services+googlers (if we want to allow all googlers to see all avaiilable projects).\n\nRight now it is https://chrome-infra-auth.appspot.com/auth/groups/config-project-access and it is a mess.",
      "range": {
        "startLine": 255,
        "startChar": 9,
        "endLine": 255,
        "endChar": 29
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "558ef23c_477b2d34",
        "filename": "appengine/components/components/config/proto/service_config.proto",
        "patchSetId": 1
      },
      "lineNbr": 263,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "This will probably be \"googlers\", since we trust googlers not to abuse this API.\n\nRight now it is https://chrome-infra-auth.appspot.com/auth/groups/config-validation and it is an utter mess (since there is no place for per-project \"can validate\" ACL in existing ACLs, so they all end up in this global group).",
      "range": {
        "startLine": 263,
        "startChar": 9,
        "endLine": 263,
        "endChar": 33
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a2c82619_2b16b755",
        "filename": "appengine/components/components/config/proto/service_config.proto",
        "patchSetId": 1
      },
      "lineNbr": 278,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "Probably \"googlers\", so they can validate infradata/config CLs.",
      "range": {
        "startLine": 278,
        "startChar": 9,
        "endLine": 278,
        "endChar": 29
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0520df2f_5afe335a",
        "filename": "appengine/components/components/config/proto/service_config.proto",
        "patchSetId": 1
      },
      "lineNbr": 281,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "Probably \"googlers\", so they can validate infradata/config CLs (they need to \"see\" them in order to be able to validate them).",
      "range": {
        "startLine": 281,
        "startChar": 9,
        "endLine": 281,
        "endChar": 33
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "51751632_82899948",
        "filename": "appengine/components/components/config/proto/service_config.proto",
        "patchSetId": 1
      },
      "lineNbr": 290,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "I\u0027m considering deprecating it too in favor of all global groups above.",
      "range": {
        "startLine": 290,
        "startChar": 9,
        "endLine": 290,
        "endChar": 20
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b1c3f298_f38c9dbd",
        "filename": "appengine/config_service/acl.py",
        "patchSetId": 1
      },
      "lineNbr": 153,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "just making it more symmetric with has_services_access...",
      "range": {
        "startLine": 151,
        "startChar": 0,
        "endLine": 153,
        "endChar": 13
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "31125137_bb5c9f87",
        "filename": "appengine/config_service/acl.py",
        "patchSetId": 1
      },
      "lineNbr": 164,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "This now essentially compares \"access: ...\" entries in project.cfg with \"role/configs.reader\" in realms.cfg (which should match for any projects that uses lucicfg and realms, by virtue of how lucicfg works). \n\nIn fact reports from this line are what led me to the CL. It was complaining that e.g. luci-scheduler@appspot.com doesn\u0027t have access to projects/infra-internal (and indeed it doesn\u0027t per realms.cfg). So I realized we need a global ACL of some sort to allowlist luci-auth-services for all project config sets. And then I realized we already have it, so I repurposed it.",
      "range": {
        "startLine": 164,
        "startChar": 9,
        "endLine": 164,
        "endChar": 30
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f544fd27_d139d15b",
        "filename": "appengine/config_service/acl.py",
        "patchSetId": 1
      },
      "lineNbr": 242,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "This would allow us to see which project rely on \"random\" entries in https://chrome-infra-auth.appspot.com/auth/groups/config-validation (or rather verify that all realms.cfg are update correctly before we remove this group).",
      "range": {
        "startLine": 237,
        "startChar": 0,
        "endLine": 242,
        "endChar": 31
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d740b595_bfb3da83",
        "filename": "appengine/config_service/acl.py",
        "patchSetId": 1
      },
      "lineNbr": 258,
      "author": {
        "id": 1002539
      },
      "writtenOn": "2021-08-18T03:56:26Z",
      "side": 1,
      "message": "just fallbacks so the code can be deployed before the config change",
      "range": {
        "startLine": 251,
        "startChar": 2,
        "endLine": 258,
        "endChar": 59
      },
      "revId": "699d77259124505e07a5409b043cd6229b501222",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}