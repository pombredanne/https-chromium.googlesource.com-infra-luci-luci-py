{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "592f14d8_1fa9d4bb",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 607,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2022-03-14T01:23:37Z",
      "side": 1,
      "message": "Could you have check for this in where we calculate lantecy instead of here?",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "314bd589_22aa8dd1",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 607,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2022-03-14T02:46:34Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "592f14d8_1fa9d4bb",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b1a8909_464906c7",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 608,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2022-03-14T01:23:37Z",
      "side": 1,
      "message": "I think it is better to record this as 0.",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "776054f1_6bc748fc",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 608,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2022-03-14T02:46:34Z",
      "side": 1,
      "message": "I don\u0027t agree. In practice it\u0027s impossible to 0 or negative latencies, they should be thrown out, as they are garbage values. We\u0027ll have SLOs defined based of these latency measurement and if we encounter too many of these negative latencies it will skew the distribution and mask true latency problems with scheduling and/or PubSub.",
      "parentUuid": "3b1a8909_464906c7",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "07136689_be8907e4",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 608,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2022-03-14T03:03:00Z",
      "side": 1,
      "message": "I think 0 or negative value happened due to lack of steady clock in appengine runtime. And in that case, I think the value can be approximated to 0. If we ignore such values, that changes aggregated latencies like p50, p90. And I think that is not better calculation than approximation to 0.",
      "parentUuid": "776054f1_6bc748fc",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c49118b5_e45b7797",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 608,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2022-03-14T04:54:41Z",
      "side": 1,
      "message": "hmmm, I think I see what you are getting it. I suppose that the clock skew will affect all latency measurements and positive latencies will be lower than usual, so the negative values will be included in the (-inf, x) bucket if we choose to make them 0. I guess if they are negative they are likely to fall in that bucket even without the clock skew issue. I\u0027ve changed it to record 0.",
      "parentUuid": "07136689_be8907e4",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47bd2f3b_3d1d4b24",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 628,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2022-03-14T01:23:37Z",
      "side": 1,
      "message": "Is it possible to log now and scheduled time inside this function if latency becomes negative?",
      "range": {
        "startLine": 628,
        "startChar": 26,
        "endLine": 628,
        "endChar": 37
      },
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d69705e2_e5c8a4f2",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 628,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2022-03-14T02:46:34Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "47bd2f3b_3d1d4b24",
      "range": {
        "startLine": 628,
        "startChar": 26,
        "endLine": 628,
        "endChar": 37
      },
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2cc3d296_f3cf0e82",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 628,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2022-03-14T02:47:27Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "d69705e2_e5c8a4f2",
      "range": {
        "startLine": 628,
        "startChar": 26,
        "endLine": 628,
        "endChar": 37
      },
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35880e94_e1ea1c31",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 629,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2022-03-14T01:23:37Z",
      "side": 1,
      "message": "I think it is better to record this as 0.",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "93a0ce54_7c284f8a",
        "filename": "appengine/swarming/ts_mon_metrics.py",
        "patchSetId": 1
      },
      "lineNbr": 629,
      "author": {
        "id": 1530772
      },
      "writtenOn": "2022-03-14T02:46:34Z",
      "side": 1,
      "message": "See above.",
      "parentUuid": "35880e94_e1ea1c31",
      "revId": "873f7a7ff997fa5d36a1b9fb15282533c3f39b38",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}