{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "315bec37_e8776e36",
        "filename": "appengine/swarming/api_helpers.py",
        "patchSetId": 4
      },
      "lineNbr": 165,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2023-09-25T17:55:49Z",
      "side": 1,
      "message": "Now I think about it, why these fields are required? \n\nActually the original code checks the existence of service_account and tags before validating them already. \n\nAnd bot_ping_tolerance is no difference than agent_binary_xx fields.",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 165,
        "endChar": 16
      },
      "revId": "54381a116ca677ad9a1de86af03e2714482a0c2f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22eb28ca_6f138969",
        "filename": "appengine/swarming/api_helpers.py",
        "patchSetId": 4
      },
      "lineNbr": 165,
      "author": {
        "id": 1551397
      },
      "writtenOn": "2023-09-25T18:04:47Z",
      "side": 1,
      "message": "I can edit the comment (and code) to make them optional. I could make an `optional_mode` instead that makes validation on all fields optional (and if optional mode is off, then full validation occurs).\n\n\u003eAnd bot_ping_tolerance is no difference than agent_binary_xx fields.\n\nNone of the fields are required until RunTask is called, so yeah during ValidateConfigs, we should just validate fields that are provided (and not require any). \n\nWhen Config is presented at the time RunTask is called, a full validation needs to be done (optional ones still remain optional). \n\nWDYT?",
      "parentUuid": "315bec37_e8776e36",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 165,
        "endChar": 16
      },
      "revId": "54381a116ca677ad9a1de86af03e2714482a0c2f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "995e1e59_da5e86fb",
        "filename": "appengine/swarming/api_helpers.py",
        "patchSetId": 4
      },
      "lineNbr": 165,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2023-09-25T18:07:27Z",
      "side": 1,
      "message": "\u003e When Config is presented at the time RunTask is called, a full validation needs to be done (optional ones still remain optional). \n\nWhat fields remain optional in RunTask validation? service_account and tags?\n\n\u003e \n\u003e WDYT?\n\nSGTM",
      "parentUuid": "22eb28ca_6f138969",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 165,
        "endChar": 16
      },
      "revId": "54381a116ca677ad9a1de86af03e2714482a0c2f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "691a2313_8995a333",
        "filename": "appengine/swarming/api_helpers.py",
        "patchSetId": 4
      },
      "lineNbr": 165,
      "author": {
        "id": 1551397
      },
      "writtenOn": "2023-09-25T19:32:49Z",
      "side": 1,
      "message": "\u003e What fields remain optional in RunTask validation? service_account and tags?\n\nCurrently `parent_run_id`, `service_account`, and `tags` are optional. \n\nI think service_account should actually be required since it is not optional when creating the TaskRequest entity (https://source.chromium.org/chromium/infra/infra/+/main:luci/appengine/swarming/backend_conversions.py;l\u003d74) for new buildbucket task backend tasks (technically it can be `None` though).\n\nCurrently swarming NewTask has it as \"optional\" (allowing it to be `None`) https://source.chromium.org/chromium/infra/infra/+/main:luci/appengine/swarming/swarming_rpcs.py;l\u003d487-501\n\nbut for buildbucket build tasks running on task backend we should probably require it? WDYT? Also @vadimsh@chromium.org thoughts?",
      "parentUuid": "995e1e59_da5e86fb",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 165,
        "endChar": 16
      },
      "revId": "54381a116ca677ad9a1de86af03e2714482a0c2f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85cd633e_e60c78f4",
        "filename": "appengine/swarming/api_helpers.py",
        "patchSetId": 4
      },
      "lineNbr": 165,
      "author": {
        "id": 1157909
      },
      "writtenOn": "2023-09-27T00:13:37Z",
      "side": 1,
      "message": "\u003e I think service_account should actually be required since it is not optional when creating the TaskRequest entity (https://source.chromium.org/chromium/infra/infra/+/main:luci/appengine/swarming/backend_conversions.py;l\u003d74) for new buildbucket task backend tasks (technically it can be `None` though).\n\nLooking at the code, it\u0027s just using the `service_account` from backend_config, and I don\u0027t see where it requires the value to be not empty. So it WAI for making it optional, right?",
      "parentUuid": "691a2313_8995a333",
      "range": {
        "startLine": 163,
        "startChar": 0,
        "endLine": 165,
        "endChar": 16
      },
      "revId": "54381a116ca677ad9a1de86af03e2714482a0c2f",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba"
    }
  ]
}