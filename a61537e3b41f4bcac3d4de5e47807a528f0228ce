{
  "comments": [
    {
      "key": {
        "uuid": "5ed89388_4bc4469e",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 15
      },
      "lineNbr": 727,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2019-11-22T07:55:38Z",
      "side": 1,
      "message": "define function before calling line?",
      "revId": "a61537e3b41f4bcac3d4de5e47807a528f0228ce",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "97bbcb20_9b4f92a1",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 15
      },
      "lineNbr": 727,
      "author": {
        "id": 1366072
      },
      "writtenOn": "2019-11-22T09:02:58Z",
      "side": 1,
      "message": "Which order is prefered in code style?\nI thought this is natural.",
      "parentUuid": "5ed89388_4bc4469e",
      "revId": "a61537e3b41f4bcac3d4de5e47807a528f0228ce",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "20075d58_5cefe74f",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 15
      },
      "lineNbr": 727,
      "author": {
        "id": 1161379
      },
      "writtenOn": "2019-11-22T09:33:37Z",
      "side": 1,
      "message": "If I see L722, I tend to find function above. So I prefer to define function before calling.\nAnd I think most of functions in our codebase are defined above the line it is called.",
      "parentUuid": "97bbcb20_9b4f92a1",
      "revId": "a61537e3b41f4bcac3d4de5e47807a528f0228ce",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5a5b7543_2094fb06",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 15
      },
      "lineNbr": 727,
      "author": {
        "id": 1114919
      },
      "writtenOn": "2019-11-22T20:23:18Z",
      "side": 1,
      "message": "FWIW, I think most of Foundation code I review in Python/Go code is structured like\n  highest level functions first, impl. details second.\nbut:\n * it\u0027s not enforced by any tooling.\n * I don\u0027t remember reading anything about this in our code style guide.\n\nI *personally* prefer highest level first precisely because I find it natural, but it\u0027s just my preference.\nDoing what nearby existing code does is more important for consistency reasons.",
      "parentUuid": "20075d58_5cefe74f",
      "revId": "a61537e3b41f4bcac3d4de5e47807a528f0228ce",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fc8ea406_9973c781",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 15
      },
      "lineNbr": 727,
      "author": {
        "id": 1366072
      },
      "writtenOn": "2019-11-25T01:20:33Z",
      "side": 1,
      "message": "I think it depends how important the function is.\nI would agree to place a base function to top if it\u0027s more important.\n\nIn this case, I just extracted a chore task to a sub function for readability. So prefer to put it after the caller since it\u0027s *less important*. It\u0027s personal preference, though.",
      "parentUuid": "5a5b7543_2094fb06",
      "revId": "a61537e3b41f4bcac3d4de5e47807a528f0228ce",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a02d9c19_06bc1553",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 15
      },
      "lineNbr": 727,
      "author": {
        "id": 1000487
      },
      "writtenOn": "2019-11-25T15:37:50Z",
      "side": 1,
      "message": "Two explanation of the current state:\n\n1. You\u0027ll see that the Swarming code base doesn\u0027t use a lot of local functions. I personally find them error prone. As soon as it becomes more a few lines I move them out as a private function. I personally find it easier to rationalize about it as now the context becomes explicit (as arguments). This removes the risk of variable aliasing.\n\n2. The reason public functions are at the end in the Swarming code base is that in python sometimes the public function would refer at private code below in a way that required it to be already defined. Two examples are function decorators and ndb.Model which requires the private function to already be defined. So for consistency I decided to put private functions at the top. In Go I do the reverse because file-local order is not significant in Go, unlike python.",
      "parentUuid": "fc8ea406_9973c781",
      "revId": "a61537e3b41f4bcac3d4de5e47807a528f0228ce",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": false
    }
  ]
}