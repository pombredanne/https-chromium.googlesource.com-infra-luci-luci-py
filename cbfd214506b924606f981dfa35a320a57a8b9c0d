{
  "comments": [
    {
      "key": {
        "uuid": "ec7edf15_a501a00a",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 10
      },
      "lineNbr": 589,
      "author": {
        "id": 1000487
      },
      "writtenOn": "2020-02-27T01:47:47Z",
      "side": 1,
      "message": "IMHO, the simpler is still better to not store BotInfo in bot_connected. I don\u0027t think this solve the problem, in fact it makes it worse, because then all task queues may get stripped.\nYes first_seen will be a bit delayed, but it\u0027s fine IMO.",
      "revId": "cbfd214506b924606f981dfa35a320a57a8b9c0d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dad8e802_dd34b966",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 10
      },
      "lineNbr": 589,
      "author": {
        "id": 1366072
      },
      "writtenOn": "2020-02-27T02:05:15Z",
      "side": 1,
      "message": "I can accept the first_seen delay since I confirmed that it looks like only for display purpose. But the issue I faced with was that there are /event API calls between handshake and first poll. And the event API need to update BotInfo.\n\nI probably could skip updating BotInfo at event API until it\u0027s created at first poll.\nBut I thought it\u0027s also not good.\n\n\u003e it makes it worse, because then all task queues may get stripped.\n\nI don\u0027t understand this. This should be better since the dimensions are kept if they are the same with the stored one, otherwise the same with before.\nBut this solution didn\u0027t work for crbug.com/1054154, since the bot had a custom dimension.\n\nI\u0027m considering to keep dimensions if they are a subset of the stored dimensions, which should cover many cases (I\u0027m not sure)",
      "parentUuid": "ec7edf15_a501a00a",
      "revId": "cbfd214506b924606f981dfa35a320a57a8b9c0d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4e0774e9_a48af499",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 10
      },
      "lineNbr": 589,
      "author": {
        "id": 1000487
      },
      "writtenOn": "2020-02-27T02:18:46Z",
      "side": 1,
      "message": "That\u0027s too bad about event. You are right, I hadn\u0027t had thought about that.\n\nI guess the right long term fix are https://crbug.com/786735 and https://crbug.com/786734.",
      "parentUuid": "dad8e802_dd34b966",
      "revId": "cbfd214506b924606f981dfa35a320a57a8b9c0d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ae4e6401_9e429180",
        "filename": "appengine/swarming/server/bot_management.py",
        "patchSetId": 10
      },
      "lineNbr": 589,
      "author": {
        "id": 1366072
      },
      "writtenOn": "2020-02-28T04:29:50Z",
      "side": 1,
      "message": "\u003e I guess the right long term fix are https://crbug.com/786735 and https://crbug.com/786734.\n\nAssuming that restart creates a new session, the session won\u0027t fix the windows perf builder.\nIIUC,they expect the dimensions to be kept even during restart for perf_device_trigger.py to be able to find eligible bots.\n\nMaybe, It\u0027s an opposite request...   \n\nWill look closely look at their script and consider a workaround.",
      "parentUuid": "4e0774e9_a48af499",
      "revId": "cbfd214506b924606f981dfa35a320a57a8b9c0d",
      "serverId": "3ce6091f-6c88-37e8-8c75-72f92ae8dfba",
      "unresolved": true
    }
  ]
}